# ðŸ“‹ PRD: Market News (Personal Investment Dashboard)

## 1. Project Overview
* **Project Name:** Market News (v1.0)
* **Objective:** Develop a personal automated dashboard that aggregates US/KR economic news, analyzes sentiment using Gemini AI, and provides a summarized briefing for a Quant Developer.
* **Core Value:** Minimize noise, maximize signal. Automated morning briefings tailored to specific investment interests.
* **Target User:** Quant Developer (Glen)

## 2. Tech Stack & Environment (Strict Constraints)
The AI agent MUST follow these technology choices:

* **Backend:**
    * **Language:** Python 3.11+
    * **Framework:** `FastAPI` (Async)
    * **Database:** `SQLite` (File-based, strictly using `SQLAlchemy` ORM)
    * **Scheduler:** `APScheduler` (Background tasks for fetching news)
    * **AI Model:** `Google Gemini 1.5 Flash` (via `google-generativeai` SDK)
* **Frontend:**
    * **Framework:** `React` (Vite) + `TypeScript`
    * **UI Library:** `shadcn/ui` (Radix UI based), `Tailwind CSS`
    * **State Management:** `TanStack Query` (React Query)
    * **Icons:** `lucide-react`
* **External APIs:**
    * **US News:** `Google News RSS` (English region) - Free & Reliable.
    * **KR News:** `Naver Search API` (News) - Requires Client ID/Secret.
    * **Market Data:** `yfinance` (Stock indices).

## 3. Data Sources & Strategy

### A. Dynamic Keyword System (Database Driven)
The system must allow the user to add/remove keywords via UI.
* **Default Keywords:**
    * `"US Stock Market"` (S&P500, Nasdaq)
    * `"Korean Stock Market"` (Kospi, Kosdaq)
    * `"Federal Reserve"` (Interest rates, FOMC)
    * `"Semiconductor"` (Nvidia, TSMC, HBM)
    * `"Artificial Intelligence"` (LLM, Generative AI)

### B. Scheduling Strategy (KST)
* **08:00 AM:** "Morning Briefing" (Focus on overnight US market results).
* **12:00 PM:** "Mid-day Check" (Focus on KR market & Asian session).
* **18:00 PM:** "Evening Wrap-up" (Focus on KR close & Pre-market US).

## 4. Database Schema (SQLAlchemy Models)

### 4.1. `keywords`
| Column | Type | Description |
| :--- | :--- | :--- |
| `id` | Integer (PK) | Auto-increment |
| `topic` | String | e.g., "Nvidia", "Fed" |
| `region` | Enum | "US" or "KR" |
| `is_active` | Boolean | To toggle tracking on/off |

### 4.2. `articles`
| Column | Type | Description |
| :--- | :--- | :--- |
| `id` | Integer (PK) | Auto-increment |
| `title` | String | Article Title |
| `link` | String (Unique) | Original URL (Primary key for deduplication) |
| `published_at` | DateTime | When the article was published |
| `source_name` | String | e.g., "CNBC", "Yonhap News" |
| `raw_snippet` | Text | Short description from RSS/API |
| `ai_summary` | Text | **Gemini Generated** (3 bullet points in Korean) |
| `sentiment` | String | **Gemini Generated** Enum: 'Bullish', 'Bearish', 'Neutral' |
| `related_tickers` | String (JSON) | e.g., `["NVDA", "005930.KS"]` |
| `keyword_tag` | String | Which keyword triggered this news |

## 5. Backend Logic (AI Agent Instructions)

### 5.1. Fetching Logic (`services/news_collector.py`)
1.  Load active keywords from DB.
2.  **If Region == US:**
    * Use `feedparser`.
    * URL: `https://news.google.com/rss/search?q={KEYWORD}+when:1d&hl=en-US&gl=US&ceid=US:en`
    * Filter: Prefer major domains (cnbc.com, bloomberg.com, wsj.com, reuters.com) if possible, but accept all high-ranking results.
3.  **If Region == KR:**
    * Use `Naver Search API` (GET `v1/search/news.json`).
    * Sort by `sim` (relevance) to avoid low-quality clickbait.
4.  **Deduplication:** Check if `link` exists in DB. If exists, skip.

### 5.2. AI Processing Logic (`services/ai_processor.py`)
* **Model:** `gemini-1.5-flash`
* **Prompt Structure:**
    ```text
    Analyze this news snippet for a quantitative developer/investor.
    Title: {title}
    Snippet: {description}
    
    Task:
    1. Summarize in Korean (3 bullet points).
    2. Sentiment: 'Bullish', 'Bearish', or 'Neutral'.
    3. Extract Tickers: Return Python list format (e.g., ["NVDA", "TSLA"]).
    
    Return JSON only.
    ```

## 6. Frontend Specifications (Dashboard UI)

### 6.1. Layout Design
* **Theme:** Dark Mode Only (`bg-slate-950`).
* **Component Library:** `shadcn/ui`.
* **Top Bar:**
    * Logo: "Market Radar"
    * **Ticker Tape:** Live indices (Nasdaq, Kospi, USD/KRW) via `yfinance`.
    * **Settings Button:** Opens a Modal to Manage Keywords (Add/Delete).
* **Left Panel (Briefing):**
    * Display "Today's Market Sentiment" (Aggregated score of Bullish vs Bearish news).
    * Top 3 "Must Read" summaries generated by AI from the collected pool.
* **Right Panel (News Feed):**
    * **Filter Tabs:** [All] [US] [KR] [Semiconductor] (Dynamic based on keywords).
    * **News Cards:**
        * Dark background (`bg-slate-900`).
        * Left Border Color: Green (Bullish), Red (Bearish), Grey (Neutral).
        * Badges: `[NVDA]`, `[Fed]`.

## 7. Implementation Roadmap for Agent

1.  **Environment Setup:** Create `.env` file structure for `GEMINI_API_KEY`, `NAVER_CLIENT_ID`, `NAVER_CLIENT_SECRET`.
2.  **Backend Skeleton:** Setup FastAPI with `SQLAlchemy` and `Alembic` (for migrations).
3.  **Core Services:** Implement `NewsCollector` (RSS/API) and `GeminiProcessor` classes.
4.  **Scheduler:** Integrate `APScheduler` to run collection jobs at 08:00, 12:00, 18:00 KST.
5.  **API Endpoints:**
    * `GET /news` (with filters)
    * `POST /keywords` (add new topic)
    * `GET /keywords` (list topics)
    * `POST /refresh` (manual trigger)
6.  **Frontend Dev:** Scaffold Vite+React, install `shadcn/ui`, build the Dashboard layout.